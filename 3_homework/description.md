# Архитектурный стиль
Исходя из требований выбран микросервисный стиль. Монолитный не подходит так как у разных частей проекта разные требования к релизам, надежности и масштабированию. Так же сервис тотализатора нужно максимально изолировать от остальной системы, чтобы про него мало кто знал.
Решено выделить такие сервисы:
1. Сервис отбора воркеров - так как у сервиса свой особый релизный цикл в один день + в него скорее всего будут часто вноситься изменения по части алгоритмов тестирования и самих тестов. В данном сервисе будет реализован microkernel стиль для того чтобы алгоритмы тестирования можно было бы расширять через систему плагинов - различные интеграции со сторонними системами тестирования, различные виды тестов и их логики.
2. Сервис заказов - будет включать в себя контексты: Привлечение клиентов, Жизненный цикл заказа и Аналитика по заказам, так как эти контексты разделяют общие данные. Для реализации этого сервиса подходит модульный монолит - на каждый контекст отдельный модуль.
3. Сервис биллинга - будет включать следующие контексты: Начисления воркерам и Выставление счетов клиентам. Здесь аналогично предполагается использовать модульный монолит - отдельный модуль под контекст. Можно вынести в отдельный сервис, чтобы не раздувать сервис заказов.
4. Сервис склада - соответствует контексту Сборка расходников для заказа. Реализует интеграцию с furtune сервисом печенек, возможно в будущем появятся интеграции с другими поставщиками расходников/наград. В этом сервисе будет достаточно layered монолита.
5. Сервис тотализатора - так как функционал должен быть "секретным", то лучше вынести в отдельный сервис и максимально изолировать от другого функционала системы. К тому же у этого сервиса скорее всего нет особенных требований к надежности и изменения в него вносить придется нечасто. Здесь достаточно layered монолита.
6. Сервис матчинга - отдельный сервис, так как опять же планируется частое изменение его логики - добавление новых шагов и алгоритмов для матчинга. Для сервиса матчинга выбран pipeline стиль архитектуры: процесс матчинга будет. разбит на шаги, определение характеристик воркера: обычный экземпляр так же будет происходить по шагам. Это даст гибкость в расширении алгоритмов матчинга.

# Хранение данных и коммуникации:
Отражено на общей схеме

# Фитнес функции:

### Общие для всей системы:


Проверка покрытия тестами важных бизнес  процессов не ниже 80%;

Проверка периодичности релиза не реже раза в две недели. Для этого можно воспользоваться метриками из джиры или поговорить с менеджерами о том, где взять информацию;

Использование общих практик и техрадара при написании кода, принятых в компании. Проверка ручная: кодревью.

Соблюдение обратной совместимости при изменении/добавлении новых событий в систему;


### Сервис матчинга:

Сбор метрик, отражающих эффективность подбора воркера, желательно иметь возможность видеть изменения в эффективности при добавлении/удалении шага из алгоритма.


### Биллинг:

Периодическая сверка бухгалтерии системы с данными платежных провайдеров.
